import{g as K,a as q,r as i,u as Q,L,w as X,x as Y,j as a,s as ee,c as B,e as ae,B as ne,y as se,m as te,z as E,A as N,E as re,h as _,S as o,T as c,D as A,C as oe,k as U}from"./index-BvjRrxQ6.js";import{a as D,T as ie}from"./GTranslate-C-yDNtg7.js";import{b as G,a as P,S as W}from"./Select-D4wFXJxD.js";import{A as F,G as O,C as ce,a as le,c as R,b as de}from"./Grid-DDopuh-h.js";const V=K("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function ue(e){return q("MuiMenuItem",e)}const j=K("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),pe=(e,s)=>{const{ownerState:t}=e;return[s.root,t.dense&&s.dense,t.divider&&s.divider,!t.disableGutters&&s.gutters]},ge=e=>{const{disabled:s,dense:t,divider:d,disableGutters:u,selected:x,classes:p}=e,g=ae({root:["root",t&&"dense",s&&"disabled",!u&&"gutters",d&&"divider",x&&"selected"]},ue,p);return{...p,...g}},me=ee(ne,{shouldForwardProp:e=>se(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:pe})(te(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${j.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${j.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${j.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${j.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${j.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${N.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${N.inset}`]:{marginLeft:52},[`& .${V.root}`]:{marginTop:0,marginBottom:0},[`& .${V.inset}`]:{paddingLeft:36},[`& .${E.root}`]:{minWidth:36},variants:[{props:({ownerState:s})=>!s.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:s})=>s.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:s})=>!s.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:s})=>s.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${E.root} svg`]:{fontSize:"1.25rem"}}}]}))),H=i.forwardRef(function(s,t){const d=Q({props:s,name:"MuiMenuItem"}),{autoFocus:u=!1,component:x="li",dense:p=!1,divider:h=!1,disableGutters:g=!1,focusVisibleClassName:f,role:T="menuitem",tabIndex:b,className:C,...S}=d,w=i.useContext(L),I=i.useMemo(()=>({dense:p||w.dense||!1,disableGutters:g}),[w.dense,p,g]),v=i.useRef(null);X(()=>{u&&v.current&&v.current.focus()},[u]);const k={...d,dense:I.dense,divider:h,disableGutters:g},n=ge(d),r=Y(v,t);let l;return d.disabled||(l=b!==void 0?b:-1),a.jsx(L.Provider,{value:I,children:a.jsx(me,{ref:r,role:T,tabIndex:l,component:x,focusVisibleClassName:B(n.focusVisible,f),className:B(n.root,C),...S,ownerState:k,classes:n})})}),xe=re(a.jsx("path",{d:"M19.74 18.33C21.15 16.6 22 14.4 22 12c0-5.52-4.48-10-10-10S2 6.48 2 12s4.48 10 10 10c2.4 0 4.6-.85 6.33-2.26.27-.22.53-.46.78-.71.03-.03.05-.06.07-.08.2-.2.39-.41.56-.62M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8c0 1.85-.63 3.54-1.69 4.9l-1.43-1.43c.69-.98 1.1-2.17 1.1-3.46 0-3.31-2.69-6-6-6s-6 2.69-6 6 2.69 6 6 6c1.3 0 2.51-.42 3.49-1.13l1.42 1.42C15.54 19.37 13.85 20 12 20m1.92-7.49c.17-.66.02-1.38-.49-1.9l-.02-.02c-.77-.77-2-.78-2.78-.04-.01.01-.03.02-.05.04-.78.78-.78 2.05 0 2.83l.02.02c.52.51 1.25.67 1.91.49l1.51 1.51c-.6.36-1.29.58-2.04.58-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4c0 .73-.21 1.41-.56 2z"})),he=[{code:"ae",name:"United Arab Emirates"},{code:"ar",name:"Argentina"},{code:"at",name:"Austria"},{code:"au",name:"Australia"},{code:"be",name:"Belgium"},{code:"bg",name:"Bulgaria"},{code:"br",name:"Brazil"},{code:"ca",name:"Canada"},{code:"ch",name:"Switzerland"},{code:"cn",name:"China"},{code:"co",name:"Colombia"},{code:"cu",name:"Cuba"},{code:"cz",name:"Czech Republic"},{code:"de",name:"Germany"},{code:"eg",name:"Egypt"},{code:"fr",name:"France"},{code:"gb",name:"United Kingdom"},{code:"gr",name:"Greece"},{code:"hk",name:"Hong Kong"},{code:"hu",name:"Hungary"},{code:"id",name:"Indonesia"},{code:"ie",name:"Ireland"},{code:"il",name:"Israel"},{code:"in",name:"India"},{code:"it",name:"Italy"},{code:"jp",name:"Japan"},{code:"kr",name:"South Korea"},{code:"lt",name:"Lithuania"},{code:"lv",name:"Latvia"},{code:"ma",name:"Morocco"},{code:"mx",name:"Mexico"},{code:"my",name:"Malaysia"},{code:"ng",name:"Nigeria"},{code:"nl",name:"Netherlands"},{code:"no",name:"Norway"},{code:"nz",name:"New Zealand"},{code:"ph",name:"Philippines"},{code:"pl",name:"Poland"},{code:"pt",name:"Portugal"},{code:"ro",name:"Romania"},{code:"rs",name:"Serbia"},{code:"ru",name:"Russia"},{code:"sa",name:"Saudi Arabia"},{code:"se",name:"Sweden"},{code:"sg",name:"Singapore"},{code:"si",name:"Slovenia"},{code:"sk",name:"Slovakia"},{code:"th",name:"Thailand"},{code:"tr",name:"Turkey"},{code:"tw",name:"Taiwan"},{code:"ua",name:"Ukraine"},{code:"us",name:"United States"},{code:"ve",name:"Venezuela"},{code:"za",name:"South Africa"}],ye=[{code:"all",name:"All languages"},{code:"ar",name:"Arabic"},{code:"de",name:"German"},{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"he",name:"Hebrew"},{code:"it",name:"Italian"},{code:"nl",name:"Dutch"},{code:"no",name:"Norwegian"},{code:"pt",name:"Portuguese"},{code:"ru",name:"Russian"},{code:"sv",name:"Swedish"},{code:"ud",name:"Urdu"},{code:"zh",name:"Chinese"}],be=e=>e&&typeof e=="object"&&Array.isArray(e.sources)?e.sources:Array.isArray(e)?e:[],fe=e=>typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"",y=e=>{const s=fe(e).trim();return s.length?s:null},ve=(e,s)=>{if(!e||typeof e!="object")return null;const t=e,d=y(t.id)||y(t._id)||`source-${s}`,u=y(t.name),x=y(t.url);if(!u||!x)return null;const p=y(t.description),h=y(t.category),g=y(t.language)?.toLowerCase()??null,f=y(t.country)?.toLowerCase()??null;return{id:d,name:u,description:p,url:x,category:h,language:g,country:f}},je={status:"idle",text:null,error:null};function Ce(){const[e,s]=i.useState("us"),[t,d]=i.useState("all"),[u,x]=i.useState([]),[p,h]=i.useState("loading"),[g,f]=i.useState(null),[T,b]=i.useState({}),[,C]=i.useTransition(),S=i.useCallback(async(n,r,l)=>{h("loading"),f(null);try{const m=await D.get("/api/get-sources",{params:{country:n,language:r},signal:l.signal}),z=be(m.data).reduce((M,J,Z)=>{const $=ve(J,Z);return $&&M.push($),M},[]);C(()=>{x(z),b({}),h("success")})}catch(m){if(l.signal.aborted)return;C(()=>{h("error"),f(m?.message||"Unable to fetch publishers right now.")})}},[]);i.useEffect(()=>{const n=new AbortController;return S(e,t,n),()=>n.abort()},[e,t,S]);const w=n=>{s(n.target.value)},I=n=>{d(n.target.value)},v=async n=>{if(n.description){b(r=>({...r,[n.id]:{status:"loading",text:null,error:null}}));try{const r=await D.post("/api/translate",{texts:[n.description]}),l=Array.isArray(r.data?.translations)?r.data.translations[0]:null;b(m=>({...m,[n.id]:{status:"success",text:l||n.description,error:null}}))}catch(r){b(l=>({...l,[n.id]:{status:"error",text:null,error:r?.message||"Unable to translate this description."}}))}}},k=()=>p==="loading"?a.jsxs(o,{alignItems:"center",spacing:2,sx:{py:6},children:[a.jsx(oe,{size:32}),a.jsx(c,{color:"text.secondary",children:"Mapping trusted publishers…"})]}):p==="error"?a.jsx(F,{severity:"error",sx:{borderRadius:3},children:g||"Something went wrong."}):u.length?a.jsx(O,{container:!0,spacing:3,children:u.map(n=>{const r=T[n.id]||je,l=!!n.description&&n.language?.toLowerCase()!=="en",m=r.text,z=m&&n.description&&m!==n.description;return a.jsx(O,{size:{xs:12,md:6},children:a.jsxs(ce,{variant:"outlined",sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:4},children:[a.jsx(le,{sx:{flexGrow:1},children:a.jsxs(o,{spacing:2,children:[a.jsxs(o,{spacing:.5,children:[a.jsx(c,{variant:"h6",fontWeight:700,children:n.name}),a.jsxs(o,{direction:"row",spacing:1,children:[n.country&&a.jsx(R,{size:"small",label:n.country.toUpperCase(),color:"primary",variant:"outlined"}),n.language&&a.jsx(R,{size:"small",label:n.language.toUpperCase(),variant:"outlined"}),n.category&&a.jsx(R,{size:"small",label:n.category,variant:"outlined"})]})]}),n.description&&a.jsx(c,{variant:"body2",color:"text.secondary",children:n.description}),r.status==="success"&&a.jsxs(o,{spacing:.5,children:[a.jsx(A,{flexItem:!0,sx:{borderStyle:"dashed"}}),a.jsx(c,{variant:"caption",color:"text.secondary",sx:{letterSpacing:.4},children:z?"English translation":"Description is already English"}),a.jsx(c,{variant:"body2",color:"text.secondary",children:m})]}),r.status==="error"&&a.jsx(F,{severity:"warning",sx:{borderRadius:2},children:r.error})]})}),a.jsx(A,{sx:{mx:3}}),a.jsx(de,{sx:{px:3,py:2},children:a.jsxs(o,{direction:{xs:"column",sm:"row"},spacing:1.5,sx:{width:"100%"},children:[a.jsx(U,{variant:"contained",color:"primary",href:n.url,target:"_blank",rel:"noopener",fullWidth:!0,children:"Visit site"}),l&&a.jsx(U,{variant:"outlined",color:"secondary",startIcon:a.jsx(ie,{fontSize:"small"}),onClick:()=>v(n),disabled:r.status==="loading",fullWidth:!0,children:r.status==="loading"?"Translating…":"Translate"})]})})]})},n.id||n.url)})}):a.jsxs(o,{alignItems:"center",spacing:1,sx:{py:6},children:[a.jsx(c,{variant:"subtitle1",fontWeight:600,children:"No sources yet"}),a.jsx(c,{variant:"body2",color:"text.secondary",children:"Try another country or language combo."})]});return a.jsx(_,{sx:{borderRadius:4,border:n=>`1px solid ${n.palette.divider}`,px:{xs:3,md:4},py:{xs:3,md:4},backgroundColor:"background.paper"},children:a.jsxs(o,{spacing:3,children:[a.jsxs(o,{spacing:1.5,children:[a.jsx(c,{variant:"h4",fontWeight:700,children:"Source radar"}),a.jsx(c,{variant:"body1",color:"text.secondary",children:"Filter by country and language to spotlight publishers. Translate descriptions instantly when a source posts in another language."})]}),a.jsxs(o,{direction:{xs:"column",sm:"row"},spacing:2,sx:{flexWrap:"wrap"},children:[a.jsxs(G,{sx:{minWidth:180},size:"small",children:[a.jsx(P,{id:"country-label",children:"Country"}),a.jsx(W,{labelId:"country-label",value:e,label:"Country",onChange:w,children:he.map(n=>a.jsx(H,{value:n.code,children:n.name},n.code))})]}),a.jsxs(G,{sx:{minWidth:200},size:"small",children:[a.jsx(P,{id:"language-label",children:"Language"}),a.jsx(W,{labelId:"language-label",value:t,label:"Language",onChange:I,children:ye.map(n=>a.jsx(H,{value:n.code,children:n.name},n.code))})]})]}),a.jsx(A,{}),k()]})})}function ke(){return a.jsxs(o,{spacing:5,children:[a.jsx(_,{sx:{borderRadius:4,px:{xs:3,md:5},py:{xs:4,md:6},background:"linear-gradient(135deg, rgba(251,191,36,0.16) 0%, rgba(244,114,182,0.16) 100%)",border:e=>`1px solid ${e.palette.divider}`},children:a.jsxs(o,{spacing:2,maxWidth:640,children:[a.jsxs(o,{direction:"row",spacing:1.5,alignItems:"center",children:[a.jsx(xe,{color:"secondary"}),a.jsx(c,{variant:"overline",color:"text.secondary",children:"Source intelligence"})]}),a.jsx(c,{variant:"h3",fontWeight:800,sx:{letterSpacing:"-0.02em"},children:"Discover local news sources from 50+ countries"}),a.jsx(c,{variant:"body1",color:"text.secondary",children:"Browse news sources from 50+ countries. Filter by country and language. Note: NewsAPI primarily indexes English-language sources. Translate descriptions to understand each publisher's focus."})]})}),a.jsx(Ce,{})]})}export{ke as default};
