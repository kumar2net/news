import{r as l,g as O,a as D,b as X,u as F,j as t,s as H,c as V,d as G,e as K,B as Y,m as J,f as ee,h as _,S as C,T as x,D as M,C as te,i as oe,I as re,k as ne}from"./index-BvjRrxQ6.js";import{a as L,T as se}from"./GTranslate-C-yDNtg7.js";import{A as U,G as E,C as ae,a as le,b as ie,c as Z}from"./Grid-DDopuh-h.js";import{L as de}from"./Link-Ddcuc3rQ.js";function ce(e){return l.Children.toArray(e).filter(o=>l.isValidElement(o))}function ue(e){return D("MuiToggleButton",e)}const w=O("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),q=l.createContext({}),Q=l.createContext(void 0);function pe(e,o){return o===void 0||e===void 0?!1:Array.isArray(o)?o.includes(e):e===o}const ge=e=>{const{classes:o,fullWidth:a,selected:g,disabled:i,size:d,color:j}=e,h={root:["root",g&&"selected",i&&"disabled",a&&"fullWidth",`size${G(d)}`,j]};return K(h,ue,o)},be=H(Y,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:a}=e;return[o.root,o[`size${G(a.size)}`]]}})(J(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${w.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${w.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(ee()).map(([o])=>({props:{color:o},style:{[`&.${w.selected}`]:{color:(e.vars||e).palette[o].main,backgroundColor:e.alpha((e.vars||e).palette[o].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[o].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[o].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),fe=l.forwardRef(function(o,a){const{value:g,...i}=l.useContext(q),d=l.useContext(Q),j=X({...i,selected:pe(o.value,g)},o),h=F({props:j,name:"MuiToggleButton"}),{children:R,className:v,color:y="standard",disabled:k=!1,disableFocusRipple:T=!1,fullWidth:p=!1,onChange:S,onClick:$,selected:r,size:b="medium",value:s,...f}=h,c={...h,color:y,disabled:k,disableFocusRipple:T,fullWidth:p,size:b},m=ge(c),z=u=>{$&&($(u,s),u.defaultPrevented)||S&&S(u,s)},B=d||"";return t.jsx(be,{className:V(i.className,m.root,v,B),disabled:k,focusRipple:!T,ref:a,onClick:z,onChange:S,value:s,ownerState:c,"aria-pressed":r,...f,children:R})});function xe(e){return D("MuiToggleButtonGroup",e)}const n=O("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),he=e=>{const{classes:o,orientation:a,fullWidth:g,disabled:i}=e,d={root:["root",a,g&&"fullWidth"],grouped:["grouped",`grouped${G(a)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return K(d,xe,o)},ye=H("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:a}=e;return[{[`& .${n.grouped}`]:o.grouped},{[`& .${n.grouped}`]:o[`grouped${G(a.orientation)}`]},{[`& .${n.firstButton}`]:o.firstButton},{[`& .${n.lastButton}`]:o.lastButton},{[`& .${n.middleButton}`]:o.middleButton},o.root,a.orientation==="vertical"&&o.vertical,a.fullWidth&&o.fullWidth]}})(J(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderTop:0,marginTop:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${n.lastButton}.${w.disabled},& .${n.middleButton}.${w.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${n.lastButton}.${w.disabled},& .${n.middleButton}.${w.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),me=l.forwardRef(function(o,a){const g=F({props:o,name:"MuiToggleButtonGroup"}),{children:i,className:d,color:j="standard",disabled:h=!1,exclusive:R=!1,fullWidth:v=!1,onChange:y,orientation:k="horizontal",size:T="medium",value:p,...S}=g,$={...g,disabled:h,fullWidth:v,orientation:k,size:T},r=he($),b=l.useCallback((B,u)=>{if(!y)return;const A=p&&p.indexOf(u);let W;p&&A>=0?(W=p.slice(),W.splice(A,1)):W=p?p.concat(u):[u],y(B,W)},[y,p]),s=l.useCallback((B,u)=>{y&&y(B,p===u?null:u)},[y,p]),f=l.useMemo(()=>({className:r.grouped,onChange:R?s:b,value:p,size:T,fullWidth:v,color:j,disabled:h}),[r.grouped,R,s,b,p,T,v,j,h]),c=ce(i),m=c.length,z=B=>{const u=B===0,A=B===m-1;return u&&A?"":u?r.firstButton:A?r.lastButton:r.middleButton};return t.jsx(ye,{role:"group",className:V(r.root,d),ref:a,ownerState:$,...S,children:t.jsx(q.Provider,{value:f,children:c.map((B,u)=>t.jsx(Q.Provider,{value:z(u),children:B},u))})})}),Ce=[{code:"us",label:"USA"},{code:"gb",label:"UK"},{code:"in",label:"India"},{code:"sg",label:"Singapore"}];function ve({value:e,onChange:o,disabled:a=!1}){const g=(i,d)=>{d!==null&&o(d)};return t.jsx(me,{value:e,exclusive:!0,onChange:g,disabled:a,sx:{flexWrap:"wrap",gap:1,"& .MuiToggleButton-root":{px:2,py:1,border:1,borderRadius:2,textTransform:"none",fontWeight:600,fontSize:"0.875rem","&.Mui-selected":{backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark"}}}},children:Ce.map(i=>t.jsx(fe,{value:i.code,children:i.label},i.code))})}const Be=e=>typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"",N=e=>{const o=Be(e).trim();return o.length?o:null},je=e=>{if(!e||typeof e!="object")return null;const o=N(e.title),a=N(e.url);if(!o||!a)return null;const g=N(e.description),i=N(e.source?.name),d=N(e.country)?.toLowerCase()??null;return{title:o,description:g,url:a,source:{name:i||"Unknown source"},country:d}},I=e=>{if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"){if(typeof e.message=="string"&&e.message.length)return typeof e.code=="string"&&e.code.length?`${e.code.toUpperCase()}: ${e.message}`:e.message;try{return JSON.stringify(e)}catch{return"An unexpected error occurred."}}try{return String(e)}catch{return"An unexpected error occurred."}},P={heading:"Country Selection",description:"Browse top headlines from around the world. Select a country to see news from that region, or view all countries together. Note: Most sources are in English."},Te=e=>Array.isArray(e)?e:e&&Array.isArray(e.articles)?e.articles:[];function Se(){const[e,o]=l.useState("all"),[a,g]=l.useState([]),[i,d]=l.useState("loading"),[j,h]=l.useState(null),[R,v]=l.useState({}),[,y]=l.useTransition(),[,k]=l.useTransition(),T=l.useCallback(async(r,b)=>{d("loading"),h(null);try{const s=await L.get("/api/news",{params:{country:r},signal:b.signal}),f=Te(s.data).map(je).filter(Boolean);y(()=>{g(f),d("success")})}catch(s){if(b.signal.aborted)return;const f=s?.response?.data?.error,c=I(f)||I(s?.message)||"Unable to load political coverage.";y(()=>{h(c),d("error")})}},[]);l.useEffect(()=>{const r=new AbortController;return T(e,r),()=>r.abort()},[e,T]);const p=r=>{r!==e&&k(()=>{o(r),v({})})},S=async r=>{const b=r.url;v(s=>({...s,[b]:{status:"loading",title:null,description:null}}));try{const s=[r.title];r.description&&s.push(r.description);const c=(await L.post("/api/translate",{texts:s})).data?.translations||[];v(m=>({...m,[b]:{status:"success",title:c[0]||r.title,description:c[1]||r.description}}))}catch{v(f=>({...f,[b]:{status:"error",error:"Translation failed"}}))}},$=()=>i==="loading"?t.jsxs(C,{alignItems:"center",spacing:2,sx:{py:6},children:[t.jsx(te,{size:36}),t.jsx(x,{color:"text.secondary",children:"Gathering the latest briefingsâ€¦"})]}):i==="error"?t.jsx(U,{severity:"error",sx:{borderRadius:3},children:typeof j=="string"&&j||"Something went wrong."}):a.length?t.jsx(E,{container:!0,spacing:3,children:a.map(r=>{const b=r.country?r.country.toUpperCase():"Unknown",s=R[r.url]||{},f=s.status==="success",c=s.title,m=s.description,z=c&&c!==r.title||m&&m!==r.description;return t.jsx(E,{size:{xs:12,md:6},children:t.jsxs(ae,{variant:"outlined",sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:4},children:[t.jsx(le,{sx:{flexGrow:1},children:t.jsxs(C,{spacing:2,children:[t.jsxs(C,{spacing:1,children:[t.jsxs(C,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsx(x,{variant:"overline",color:"text.secondary",sx:{letterSpacing:.6},children:r.source?.name||"Unknown source"}),t.jsx(oe,{title:"Translate to English",children:t.jsx(re,{size:"small",onClick:()=>S(r),disabled:s.status==="loading",color:f?"primary":"default",children:t.jsx(se,{fontSize:"small"})})})]}),t.jsx(x,{variant:"h6",component:"h3",children:r.title})]}),r.description&&t.jsx(x,{variant:"body2",color:"text.secondary",children:r.description}),f&&z&&t.jsxs(C,{spacing:.5,children:[t.jsx(M,{flexItem:!0,sx:{borderStyle:"dashed"}}),t.jsx(x,{variant:"caption",color:"primary",sx:{letterSpacing:.4,fontWeight:600},children:"English Translation"}),c&&c!==r.title&&t.jsx(x,{variant:"h6",component:"h3",sx:{fontStyle:"italic"},children:c}),m&&m!==r.description&&t.jsx(x,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:m})]}),s.status==="error"&&t.jsx(U,{severity:"warning",sx:{borderRadius:2},children:s.error})]})}),t.jsx(M,{sx:{mx:3}}),t.jsx(ie,{sx:{px:3,py:2,pt:2.5},children:t.jsxs(C,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{width:"100%"},children:[t.jsx(Z,{label:b,size:"small",color:"primary",variant:"outlined",sx:{fontWeight:600}}),t.jsx(ne,{component:de,href:r.url,target:"_blank",rel:"noopener",variant:"contained",children:"Read more"})]})})]})},r.url)})}):t.jsxs(C,{alignItems:"center",spacing:1,sx:{py:6,color:"text.secondary",textAlign:"center"},children:[t.jsx(x,{variant:"subtitle1",fontWeight:600,children:"No articles found"}),t.jsx(x,{variant:"body2",children:"No political stories were found for the selected country."})]});return t.jsx(_,{sx:{borderRadius:4,border:r=>`1px solid ${r.palette.divider}`,px:{xs:3,md:4},py:{xs:3,md:4},backgroundColor:"background.paper"},children:t.jsxs(C,{spacing:3,children:[t.jsxs(C,{spacing:1.5,children:[t.jsx(x,{variant:"h4",fontWeight:700,children:P.heading}),t.jsx(x,{variant:"body1",color:"text.secondary",children:P.description})]}),t.jsx(ve,{value:e,onChange:p,disabled:i==="loading"}),t.jsx(M,{}),$()]})})}function ze(){return t.jsxs(C,{spacing:5,children:[t.jsx(_,{sx:{borderRadius:4,px:{xs:3,md:5},py:{xs:5,md:7},background:"linear-gradient(135deg, rgba(79,70,229,0.14) 0%, rgba(236,72,153,0.18) 100%)",border:e=>`1px solid ${e.palette.divider}`},children:t.jsxs(C,{spacing:2,maxWidth:600,children:[t.jsx(Z,{label:"Global News",color:"primary",variant:"outlined",sx:{alignSelf:"flex-start",fontWeight:600}}),t.jsx(x,{variant:"h3",fontWeight:800,sx:{letterSpacing:"-0.02em"},children:"Headlines from around the world"}),t.jsx(x,{variant:"body1",color:"text.secondary",children:"Browse top headlines from 50+ countries around the world. Note: Most sources are in English due to API limitations. Translate any article with one tap."})]})}),t.jsx(Se,{})]})}export{ze as default};
